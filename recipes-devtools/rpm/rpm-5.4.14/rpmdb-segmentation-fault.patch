--- rpm-5.4.9/rpmdb/header.c	2014-07-01 04:35:25.000000000 +0530
+++ rpm-5.4.9/rpmdb/header.c.orig	2014-07-01 04:34:35.000000000 +0530
@@ -368,8 +368,9 @@
 	} else {
 	    const char ** av = (*p).argv;
 	    while (count--) {
-		/* add one for null termination */
-		length += strlen(*av++) + 1;
+		/* add one for null termination */
+                if (*av)
+		    length += strlen(*av++) + 1;
 	    }
 	}
 	break;
