From c008aa8fb15dd8fe94e8db2c7fca0b127d8eacaf Mon Sep 17 00:00:00 2001
From: dan <dan@noemail.net>
Date: Fri, 3 Apr 2020 11:52:59 +0000
Subject: [PATCH] Do not suppress errors when resolving references in an ORDER
 BY clause belonging to a compound SELECT within a view or trigger within
 ALTER TABLE. Fix for ticket [a10a14e9b4ba2].

FossilOrigin-Name: 684293882c302600e112cf52553c19d84fdb31663d96e5dd7f8ac17dda00a026

Upstream-Status: Backport https://github.com/sqlite/sqlite/commit/4db7ab53f9c30e2e22731ace93ab6b18eef6c4ae
CVE: CVE-2020-11656 (#2)

Signed-off-by: Rahul Kumar <rahulk@mvista.com>
---
 sqlite3.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/sqlite3.c b/sqlite3.c
index a657ac9..a491dde 100644
--- a/sqlite3.c
+++ b/sqlite3.c
@@ -97945,7 +97945,7 @@ static int resolveOrderByTermToExprList(
   nc.nErr = 0;
   db = pParse->db;
   savedSuppErr = db->suppressErr;
-  db->suppressErr = 1;
+  if( IN_RENAME_OBJECT==0 ) db->suppressErr = 1;
   rc = sqlite3ResolveExprNames(&nc, pE);
   db->suppressErr = savedSuppErr;
   if( rc ) return 0;
